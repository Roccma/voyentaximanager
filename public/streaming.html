<!DOCTYPE html>
<html>
<head>
	<title>Voy en Taxi</title>
	<link rel = "stylesheet" href = "../css/app.css"/>
	<script src = "https://static.opentok.com/v2/js/opentok.min.js"></script>
	<link href="../css/bootstrap.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="../css/dashboard.css" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
</head>
<body class = "pagebody">
	<nav class = "menu">
	  <div class="container-fluid menucontainer">
	    <div class="navbar-header" style = "margin-top: 5px">
	      <img height="55" src="/img/Logo.png">
	    </div>

		<div class = "opcionesMenu">
			<div id = "opcionEmergencias" class = "divIcono" onclick="window.location.href = 'index.html'">
				<i class = "fa fa-phone"></i> <span>Emergencias</span>
			</div>
			<div id = "opcionFinalizadas" class = "divIcono" onclick="window.location.href = 'finalizadas.html'">				
				<i class = "fa fa-phone-slash"></i> <span>Finalizadas</span>
			</div>
			<div id = "opcionLocalizacion" class = "divIcono" onclick="window.location.href = 'gps.html'">
				<i class = "fa fa-map-marker-alt"></i> <span>Localización</span>
			</div>
			<div id = "opcionEstadisticas" class = "divIcono">
				<i class = "fa fa-chart-pie"></i> <span>Estadísticas</span>
			</div>
			<div id = "opcionOpenTok" class = "divIcono" data-toggle="modal" data-target="#modalCredenciales">
				<i class = "fa fa-plug"></i> <span>Credenciales</span>
			</div>
		</div>

	  </div>
	</nav>
	<div class = "main2">
		<div id = "videos" style = "margin-top: 30px;">
			<div>
				<div class = "contenedorSubscriber">
					<div class = "tituloContenedorSubscriber"><i class = "fa fa-video"></i> Videollamada</div>
					<div id = "subscriber">
					</div>
				</div>
				<div class = "contenedorMapa">
					<div class = "tituloContenedorMapa"><i class = "fa fa-map-marker-alt"></i> Ubicaci&oacute;n</div>
					<div id = "map"></div>
				</div>
			</div>	
			<div class = "contenedorPublisher">
				<div class = "tituloContenedorPublisher"><i class = "fa fa-user-alt"></i> Operador</div>
				<div id = "publisher"></div>
			</div>	
			<div class = "contenedorBotones">
				<div class = "botonAccion" id = "finalizarLlamada" onclick = "finishHelp();">
					<i class = "fa fa-phone-slash"></i> Finalizar
				</div>
				<div class = "botonAccion" id = "intentarReconectar" onclick = "refresh();">
					<i class = "fa fa-sync-alt"></i> Intentar reconectar
				</div>
			</div>
			<div class = "contenedorDatos">
				<div class = "tituloContenedorDatos"><i class = "fa fa-file-alt"></i> Información del taxista</div>
				<table id = "tablaDatos">
				</table>
			</div>
		</div>
	</div>
	<script src = "/socket.io/socket.io.js"></script>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/leaflet.js"></script>
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/leaflet.css"/>
	<script src="https://www.mapquestapi.com/sdk/leaflet/v2.2/mq-map.js?key=d0c5GU6bqLUS3GXzuVmJj5rhgVAiSofA"></script>
	<script src="https://www.mapquestapi.com/sdk/leaflet/v2.2/mq-routing.js?key=d0c5GU6bqLUS3GXzuVmJj5rhgVAiSofA"></script>
	<!--<script src="https://unpkg.com/leaflet@1.0.2/dist/leaflet.js"></script>-->
	<script src = "../js/leaflet.awesome-markers.js"></script>
	<!--<link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.2/dist/leaflet.css" />-->
	<script src="https://unpkg.com/ionicons@4.2.4/dist/ionicons.js"></script>
	<link rel="stylesheet" href="http://code.ionicframework.com/ionicons/1.5.2/css/ionicons.min.css"/>
	<link rel = "stylesheet" href = "../css/leaflet.awesome-markers.css"/>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>	
	<!--	
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
	<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD1duDqyFKrvApr3AOjfQFWnDe-ODP2WpE&callback=initMap"async defer></script> -->
	<script src = "../js/streaming.js"></script>

	<footer class = "footer">
		<center>Voy en Taxi | Bot&oacute;n de Alerta | 2018</center>
	</footer>
	<script type="text/javascript">
		$(document).on('ready', function(){
			let url = location.href;

			let urlSplit = url.split("?");

			let credentialsParts = urlSplit[1].split('&');

			let sessionId = credentialsParts[0].replace("sessionid=", "");

			jQuery.ajax({
				url : 'http://127.0.0.1:8080/VoyEnTaxiWS/usuarios.php/DatosTaxista',
				type : 'GET',
				dataType : 'json',
				data : {'sessionId' : sessionId}
			})
			.done(function(response){
				document.getElementById('tablaDatos').innerHTML = 
					"<tr>" +
						"<td><b>Nombre:</b><br> " + response['nombre'] + "</td>" +
						"<td><b>Cédula de Identidad:</b><br> " + response['cedula'] + "</td>" +						
						"<td><b>Celular:</b><br> " + response['telefono'] + "</td>" +
					"</tr>" +
					"<tr>" +
						"<td><b>Apellido:</b><br> " + response['apellido'] + "</td>" +
						"<td><b>Correo electrónico:</b><br> " + response['email'] + "</td>" +						
						"<td><b>Empresa:</b><br> La de Arjona</td>" +
					"</tr>";
			});
		})
	</script>
</body>
</html>